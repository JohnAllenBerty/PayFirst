<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PayFirst</title>
  </head>
  <body>
    <div id="root"></div>
    <script>
      // If redirected from 404.html with ?p=<encodedPath>, rewrite the URL back to the intended route
      (function() {
        try {
          var params = new URLSearchParams(window.location.search);
          var p = params.get('p');
          if (p) {
            var decoded = decodeURIComponent(p);
            // For custom domain at root (/), use the decoded path directly
            // For subpath hosting (e.g., /PayFirst/), compute base and join properly
            var path = window.location.pathname;
            var base = path === '/' ? '/' : path.substring(0, path.lastIndexOf('/') + 1);
            var newUrl;
            if (base === '/') {
              // Custom domain at root: use decoded path directly
              newUrl = decoded;
            } else {
              // Subpath hosting: join base and decoded route
              newUrl = base.replace(/\/$/, '/') + decoded.replace(/^\//, '');
            }
            window.history.replaceState(null, '', newUrl);
          }
        } catch (_) { /* no-op */ }
      })();
    </script>
    <!-- Vite will replace this with built asset references during production build -->
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
