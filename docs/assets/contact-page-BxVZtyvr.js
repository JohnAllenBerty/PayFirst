import{j as e,t as He,u as Je}from"./vendor-radix-DPBOYssM.js";import{r,a as Ke}from"./vendor-redux-Waidrk23.js";import{m as Ze,n as We,p as Xe,f as Ye,q as es,r as ss,s as ts,t as as,y as x,B as i,I as U,L as j,j as V,k as O,l as ns}from"./index-BIOy0VsF.js";import{S as A}from"./skeleton-BJne5ia_.js";import{T as rs,b as is,c as M,d as se,A as ls,a as cs,e as p,f as os}from"./table-CyX7VhNa.js";import{u as ds}from"./useMeta-Di2vcA2e.js";import{F as ms,L as us,C as xs}from"./layout-list-Bz1OwZx6.js";import{S as Pe}from"./search-lPmJvCx4.js";import"./vendor-react-gH-7aFTg.js";import"./vendor-router-Du5tOU4S.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],hs=Ze("check",ps);function Ee({className:w,...B}){return e.jsx(He,{"data-slot":"checkbox",className:We("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",w),...B,children:e.jsx(Je,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(hs,{className:"size-3.5"})})})}const Ss=()=>{const[w,B]=r.useState("name"),[F,g]=r.useState(1),[$,Le]=r.useState(10),[f,te]=r.useState(!1),[v,ae]=r.useState(""),[k,D]=r.useState({name:""}),[Ae,ne]=r.useState(0),{data:q,isLoading:Q,isFetching:re}=Xe({page:f?1:F,page_size:f?1e3:$,ordering:w,search:k.name||void 0,refresh:Ae}),{data:c,isLoading:Me,refetch:Fe}=Ye(),[De,{isLoading:Ge}]=es(),[Ie,{isLoading:Te}]=ss(),[Re,{isLoading:G}]=ts(),[H,ie]=r.useState(""),[le,ce]=r.useState([]),[oe,I]=r.useState(null),[_e,S]=r.useState(!1),[de,me]=r.useState(null),[ue,z]=r.useState(null),[P,b]=r.useState(null),[J,T]=r.useState(""),[xe,R]=r.useState([]),[pe,y]=r.useState(null),[E,he]=r.useState(null),[ge,K]=r.useState(null),[Ue,L]=r.useState(!1),[je,fe]=r.useState(null),[be,Ve]=r.useState("google"),[Oe,{isLoading:Ne}]=as(),l=r.useMemo(()=>c&&typeof c!="string"&&c?.status?c?.data:[],[c]),ve=r.useMemo(()=>{const s=q;if(!s)return{items:[],total:0};if(s.status===!0){const n=s.data;return Array.isArray(n)?{items:n,total:n.length}:{items:n.results??[],total:n.count??(n.results?n.results.length:0)}}if(s.status===!1)return{items:[],total:0};const t=s;return Array.isArray(t.results)?{items:t.results,total:t.count}:{items:[],total:0}},[q]),h=ve.items,_=ve.total,ye=typeof c=="string"?c:c&&typeof c!="string"&&c.status===!1?String(c.error??"Server error"):null,Ce=(()=>{const s=q;return s&&s.status===!1?String(s.error??"Server error"):null})(),Be=(s,t)=>{ce(a=>t?Array.from(new Set([...a,s])):a.filter(n=>n!==s))},$e=async s=>{if(s.preventDefault(),I(null),!H.trim())return I("Name is required"),!1;try{const t=new FormData;t.append("name",H.trim()),le.forEach(n=>t.append("groups",String(n))),de&&t.append("picture",de);const a=await De(t).unwrap();return ie(""),ce([]),me(null),x.success(V(a,"Contact created")),!0}catch(t){const a=O(t);return I(a),x.error(a),!1}},we=r.useMemo(()=>Array.isArray(l)&&l.some(s=>Array.isArray(s.subgroups)&&s.subgroups.length>0),[l]),ke=r.useMemo(()=>{if(!l)return[];if(we){const a=n=>({id:n.id,name:n.name,parent_group:n.parent_group??null,children:Array.isArray(n.subgroups)?n.subgroups.map(a):[]});return l.map(a)}const s=new Map,t=[];return l.forEach(a=>s.set(a.id,{id:a.id,name:a.name,parent_group:a.parent_group??null,children:[]})),l.forEach(a=>{const n=s.get(a.id);a.parent_group&&s.has(a.parent_group)?s.get(a.parent_group).children.push(n):t.push(n)}),t},[l,we]),qe=r.useMemo(()=>{const s=new Map;return h.forEach(t=>{(t.groups||[]).forEach(n=>{const o=s.get(n)||[];o.push(t),s.set(n,o)})}),s},[h]),Z=r.useMemo(()=>h.filter(s=>!s.groups||s.groups.length===0),[h]),Se=r.useRef("");r.useEffect(()=>{if(!!!(k.name&&k.name.trim()))return;const t=_,a=`${k.name}`;!Q&&t===0&&Se.current!==a&&(Se.current=a,x.info("No contacts match your filter. Adjust or clear filters to see results."))},[k.name,_,Q]);const ze=({node:s,depth:t,contactsByGroup:a,onView:n,onEdit:o,onDelete:d})=>{const[C,m]=Ke.useState(!0),N=s.children||[],X=a.get(s.id)||[],Y=N.length>0,ee=X.length>0;return e.jsxs("li",{className:"text-sm",style:{paddingLeft:t*12},children:[e.jsx("div",{className:"flex items-center justify-between py-1.5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[Y||ee?e.jsx("button",{type:"button","aria-label":C?"Collapse":"Expand",className:"text-muted-foreground hover:text-foreground transition-colors",onClick:()=>m(u=>!u),children:C?e.jsx(xs,{className:"size-4"}):e.jsx(ns,{className:"size-4"})}):e.jsx("span",{className:"inline-block w-4"}),e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx("span",{children:s.name}),(ee||Y)&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",X.length,Y?`, ${N.length} sub`:"",")"]})]})]})}),C&&e.jsxs("div",{className:"ml-3",children:[ee&&e.jsx("ul",{className:"space-y-1",children:X.map(u=>e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsx("span",{children:u.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>n(u.id),children:"View"}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>o(u),children:"Edit"}),e.jsx(i,{size:"sm",variant:"destructive",onClick:()=>d(u.id),disabled:G,children:"Delete"})]})]},u.id))}),N.length>0&&e.jsx("ul",{className:"border-l pl-3 mt-1",children:N.map(u=>e.jsx(ze,{node:u,depth:t+1,contactsByGroup:a,onView:n,onEdit:o,onDelete:d},u.id))})]})]})},{title:Qe}=ds("/contact","Contacts • PayFirst"),W=s=>s.picture;return r.useEffect(()=>{let s=null;if(P===null)K(null),he(null);else if(E)s=URL.createObjectURL(E),K(s);else{const t=h.find(n=>n.id===P),a=t?W(t)??null:null;K(a)}return()=>{s&&URL.revokeObjectURL(s)}},[P,E,h]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:Qe.replace(/\s*•\s*PayFirst$/,"")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your contacts and assign them to groups."})]}),ye&&e.jsxs("div",{className:"max-w-xl rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 flex items-center justify-between gap-3",children:[e.jsx("span",{children:ye}),e.jsx(i,{type:"button",size:"sm",variant:"outline",onClick:()=>Fe(),children:"Retry"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(i,{size:"sm",variant:"outline",onClick:()=>L(!0),children:"Import CSV"})}),e.jsx(i,{size:"sm",onClick:()=>{S(!0),I(null)},children:"New Contact"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h2",{className:"font-medium",children:"All contacts"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[!f&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-muted-foreground",htmlFor:"contact-page-size",children:"Rows per page"}),e.jsxs("select",{id:"contact-page-size",className:"h-8 rounded-md border bg-background px-2 text-sm",value:$,onChange:s=>{Le(Number(s.target.value)),g(1)},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]}),e.jsxs(i,{variant:f?"default":"outline",size:"sm",className:"gap-1",onClick:()=>{te(!0),g(1)},children:[e.jsx(ms,{className:"size-4"})," Tree"]}),e.jsxs(i,{variant:f?"outline":"default",size:"sm",className:"gap-1",onClick:()=>te(!1),children:[e.jsx(us,{className:"size-4"})," List"]})]})]}),Ce&&e.jsxs("div",{className:"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 flex items-center justify-between gap-3",children:[e.jsx("span",{children:Ce}),e.jsx(i,{type:"button",size:"sm",variant:"outline",onClick:()=>ne(s=>s+1),children:"Retry"})]}),f?e.jsxs("div",{className:"rounded-md border divide-y",children:[e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(U,{value:v,onChange:s=>ae(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),D({name:v.trim().toLowerCase()}),g(1))},placeholder:"Filter name…",className:"pl-8 h-8 w-64"}),e.jsx(Pe,{className:"absolute left-2 top-2 size-4 text-muted-foreground"})]}),e.jsx(i,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2",disabled:re,onClick:()=>{D({name:v.trim().toLowerCase()}),g(1)},children:"Apply"})]}),e.jsxs("ul",{className:"p-2",children:[ke.map(s=>e.jsx(ze,{node:s,depth:0,contactsByGroup:qe,onView:t=>z(t),onEdit:t=>{b(t.id),T(t.name),R(t.groups||[])},onDelete:t=>y(t)},s.id)),Z.length>0&&e.jsxs("li",{className:"pt-2",children:[e.jsx("div",{className:"font-medium text-sm mb-1",children:"Ungrouped"}),e.jsx("ul",{className:"ml-3 space-y-1",children:Z.map(s=>e.jsxs("li",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>z(s.id),children:"View"}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{b(s.id),T(s.name),R(s.groups||[])},children:"Edit"}),e.jsx(i,{size:"sm",variant:"destructive",onClick:()=>y(s.id),disabled:G,children:"Delete"})]})]},s.id))})]}),ke.length===0&&Z.length===0&&e.jsx("li",{className:"text-sm text-muted-foreground",children:"No contacts found"})]})]}):e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(rs,{children:[e.jsxs(is,{children:[e.jsxs(M,{children:[e.jsx(se,{className:"cursor-pointer select-none",onClick:()=>B(s=>s==="name"?"-name":"name"),children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:["Name ",w.includes("name")&&(w.startsWith("-")?e.jsx(ls,{className:"size-4"}):e.jsx(cs,{className:"size-4"}))]})}),e.jsx(se,{children:"Groups"}),e.jsx(se,{className:"w-[1%] whitespace-nowrap text-right pr-3",children:"Actions"})]}),e.jsxs(M,{children:[e.jsx(p,{children:e.jsxs("div",{className:"relative",children:[e.jsx(U,{value:v,onChange:s=>{ae(s.target.value)},onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),D({name:v.trim().toLowerCase()}),g(1))},placeholder:"Filter name…",className:"pl-8 h-8"}),e.jsx(Pe,{className:"absolute left-2 top-2 size-4 text-muted-foreground"})]})}),e.jsx(p,{}),e.jsx(p,{className:"text-right pr-3",children:e.jsx(i,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2",disabled:re,onClick:()=>{D({name:v.trim().toLowerCase()}),g(1)},children:"Apply"})})]})]}),e.jsx(os,{children:Q?Array.from({length:5}).map((s,t)=>e.jsxs(M,{children:[e.jsx(p,{children:e.jsx(A,{className:"h-4 w-40"})}),e.jsx(p,{children:e.jsx(A,{className:"h-4 w-24"})}),e.jsx(p,{className:"text-right pr-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(A,{className:"h-8 w-16"}),e.jsx(A,{className:"h-8 w-16"}),e.jsx(A,{className:"h-8 w-16"})]})})]},t)):h.length?h.map(s=>e.jsxs(M,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[(()=>{const t=W(s);return t?e.jsx("img",{src:t,alt:s.name,className:"h-8 w-8 rounded-full object-cover border",loading:"lazy"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-muted flex items-center justify-center text-xs font-medium border",children:s.name?.charAt(0)?.toUpperCase()||"?"})})(),e.jsx("div",{className:"font-medium",children:s.name})]})}),e.jsx(p,{className:"text-muted-foreground",children:(()=>{const t=new Map;l.forEach(d=>t.set(d.id,d));const a=d=>{const C=[];let m=t.get(d);const N=new Set;for(;m&&!N.has(m.id)&&(N.add(m.id),C.unshift(m.name),m.parent_group&&t.has(m.parent_group));)m=t.get(m.parent_group);return C.join(" > ")},n=s.groups||[];if(!n.length)return"—";const o=n.map(a).filter(Boolean);return o.length?o.join(", "):n.map(d=>t.get(d)?.name||String(d)).join(", ")})()}),e.jsx(p,{className:"text-right pr-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>z(s.id),children:"View"}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{b(s.id),T(s.name),R(s.groups||[])},children:"Edit"}),e.jsx(i,{size:"sm",variant:"destructive",onClick:()=>y(s.id),disabled:G,children:"Delete"})]})})]},s.id)):e.jsx(M,{children:e.jsx(p,{colSpan:3,className:"text-sm text-muted-foreground",children:"No contacts found"})})})]})}),(()=>{const s=Math.max(1,Math.ceil(_/$));return!f&&_>0?e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>g(t=>Math.max(1,t-1)),disabled:F===1,children:"Prev"}),e.jsxs("span",{className:"text-xs",children:["Page ",F," of ",s]}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>g(t=>Math.min(s,t+1)),disabled:F>=s,children:"Next"})]}):null})()]}),_e&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>S(!1),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"new-contact-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"new-contact-title",className:"font-semibold",children:"New contact"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>S(!1),children:"Close"})]}),e.jsxs("form",{onSubmit:async s=>{await $e(s)&&S(!1)},className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"name",children:"Name"}),e.jsx(U,{id:"name",value:H,onChange:s=>ie(s.target.value),placeholder:"Jane Doe"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"picture",children:"Picture"}),e.jsx("input",{id:"picture",type:"file",accept:"image/*",onChange:s=>me(s.target.files?.[0]||null),className:"h-9 rounded-md border bg-background px-2 text-sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Optional. JPG/PNG recommended."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Groups"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Me?e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading groups…"}):l.length?l.map(s=>e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ee,{checked:le.includes(s.id),onCheckedChange:t=>Be(s.id,!!t)}),e.jsx("span",{children:s.name})]},s.id)):e.jsx("span",{className:"text-sm text-muted-foreground",children:"No groups yet"})})]}),oe&&e.jsx("div",{className:"text-sm text-red-600",children:oe}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e.jsx(i,{type:"submit",disabled:Ge,children:"Create"})]})]})]})}),ue!==null&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>z(null),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"view-contact-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"view-contact-title",className:"font-semibold",children:"Contact details"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>z(null),children:"Close"})]}),(()=>{const s=h.find(a=>a.id===ue);if(!s)return e.jsx("div",{className:"text-sm",children:"Not found"});const t=(s.groups||[]).map(a=>l.find(n=>n.id===a)?.name||String(a));return e.jsxs("div",{className:"text-sm space-y-2",children:[(()=>{const a=W(s);return e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Picture:"}),e.jsx("div",{className:"pt-1",children:a?e.jsx("img",{src:a,alt:s.name,className:"h-20 w-20 rounded-md object-cover border"}):e.jsx("div",{className:"h-20 w-20 rounded-md bg-muted flex items-center justify-center text-base font-medium border",children:s.name?.charAt(0)?.toUpperCase()||"?"})})]})})(),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"})," ",s.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Groups:"})," ",t.length?t.join(", "):"—"]})]})})()]})}),P!==null&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>b(null),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"edit-contact-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"edit-contact-title",className:"font-semibold",children:"Edit contact"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>b(null),children:"Close"})]}),e.jsxs("form",{className:"grid gap-3",onSubmit:async s=>{s.preventDefault();try{const t=P,a=new FormData;a.append("name",J.trim()),xe.forEach(o=>a.append("groups",String(o))),E&&a.append("picture",E);const n=await Ie({id:t,changes:a}).unwrap();x.success(V(n,"Contact updated")),b(null)}catch(t){x.error(O(t))}},children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-name",children:"Name"}),e.jsx(U,{id:"edit-name",value:J,onChange:s=>T(s.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-picture",children:"Picture"}),e.jsx("input",{id:"edit-picture",type:"file",accept:"image/*",onChange:s=>{const t=s.target.files?.[0]||null;he(t)},className:"h-9 rounded-md border bg-background px-2 text-sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Optional. Upload to replace existing picture."}),ge&&e.jsx("div",{className:"pt-2",children:e.jsx("img",{src:ge,alt:J||"Contact picture",className:"h-20 w-20 rounded-md object-cover border"})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Groups"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:l.map(s=>e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ee,{checked:xe.includes(s.id),onCheckedChange:t=>R(a=>t?Array.from(new Set([...a,s.id])):a.filter(n=>n!==s.id))}),e.jsx("span",{children:s.name})]},s.id))})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>b(null),children:"Cancel"}),e.jsx(i,{type:"submit",disabled:Te,children:"Save"})]})]})]})}),pe!==null&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>y(null),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"delete-contact-title",className:"bg-background rounded-md p-4 w-[420px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{id:"delete-contact-title",className:"font-semibold mb-2",children:"Delete contact"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"This action cannot be undone."}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>y(null),children:"Cancel"}),e.jsx(i,{variant:"destructive",disabled:G,onClick:async()=>{try{const s=await Re(pe).unwrap();x.success(V(s,"Contact deleted"))}catch(s){x.error(O(s))}finally{y(null)}},children:"Delete"})]})]})}),Ue&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>L(!1),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"import-contacts-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"import-contacts-title",className:"font-semibold",children:"Import contacts from CSV"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>L(!1),children:"Close"})]}),e.jsxs("form",{className:"grid gap-3",onSubmit:async s=>{if(s.preventDefault(),!je){x.error("Please choose a CSV file");return}try{const t=await Oe({file:je,_type:be}).unwrap();x.success(V(t,"Import started")),L(!1),fe(null),ne(a=>a+1)}catch(t){x.error(O(t))}},children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"import-file",children:"CSV file"}),e.jsx("input",{id:"import-file",type:"file",accept:".csv,text/csv",onChange:s=>fe(s.target.files?.[0]||null),className:"h-9 rounded-md border bg-background px-2 text-sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Upload a CSV exported from Google Contacts."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"import-type",children:"Type"}),e.jsx("select",{id:"import-type",className:"h-9 rounded-md border bg-background px-2 text-sm",value:be,onChange:s=>Ve(s.target.value),children:e.jsx("option",{value:"google",children:"Google"})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsx(i,{type:"submit",disabled:Ne,children:Ne?"Importing…":"Import"})]})]})]})})]})};export{Ss as default};
