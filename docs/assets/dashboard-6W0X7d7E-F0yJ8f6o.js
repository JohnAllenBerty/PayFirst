import{U as $,y as T,v as h,x as s,n as c,a as m,r as x,i as o,Z as p}from"./index-DnKD0KXe.js";import{o as l}from"./skeleton-mX7TdaWE-Cq_BwO7K.js";import{a as _}from"./useMeta-Do0ZXGYI-DbPzVoKD.js";const C=()=>{const{data:N,isLoading:u}=$(),{data:f,isLoading:w}=T(),{title:M}=_("/","Dashboard • PayFirst"),r=h.useMemo(()=>{const e=N;return e?Array.isArray(e)?e:typeof e!="string"&&e?.status?e?.data??[]:[]:[]},[N]),b=h.useMemo(()=>{const e=f;return e?Array.isArray(e)?e:typeof e!="string"&&e?.status?e?.data??[]:[]:[]},[f]),g=h.useMemo(()=>{const e=(a,t)=>a.reduce((d,n)=>{const i=Object.entries(n).find(([O])=>t.test(O))?.[1],v=typeof i=="number"?i:Number(i??0);return d+(isFinite(v)?v:0)},0);return{totalTxn:e(r,/total_transaction_amount/i),totalRep:e(r,/total_repayment_amount/i),totalPending:e(r,/pending_amount/i)}},[r]),j=h.useMemo(()=>r.map(e=>{const a=String(Object.entries(e).find(([n])=>/name|label|contact/i.test(n))?.[1]??"Unknown"),t=Object.entries(e).find(([n])=>/pending_amount/i.test(n))?.[1],d=typeof t=="number"?t:Number(t??0);return{name:a,pending:isFinite(d)?d:0}}).sort((e,a)=>a.pending-e.pending).slice(0,5),[r]),y=h.useMemo(()=>Math.max(0,...j.map(e=>e.pending)),[j]);return s.jsxs("div",{className:"h-full bg-gray-50 p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold",children:M.replace(/\s*•\s*PayFirst$/,"")}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Overview and quick insights."})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[{title:"Total transactions",value:g.totalTxn},{title:"Total repayments",value:g.totalRep},{title:"Pending amount",value:g.totalPending}].map((e,a)=>s.jsxs(c,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(x,{className:"text-base",children:e.title})}),s.jsx(o,{children:u?s.jsx(l,{className:"h-8 w-24"}):s.jsx("div",{className:"text-2xl font-semibold",children:e.value})})]},a))}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u?Array.from({length:3}).map((e,a)=>s.jsxs(c,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(l,{className:"h-5 w-40"})}),s.jsx(o,{children:s.jsx(l,{className:"h-8 w-24"})})]},a)):r.length?r.map((e,a)=>{const t=Object.entries(e||{}),d=String(t.find(([i])=>/name|label|contact/i.test(i))?.[1]??`Item ${a+1}`),n=t.find(([i])=>/pending|amount|total/i.test(i))?.[1];return s.jsxs(c,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(x,{className:"text-base",children:d})}),s.jsx(o,{children:typeof n=="number"?s.jsx("div",{className:"text-2xl font-semibold",children:n}):s.jsx("div",{className:"text-sm text-muted-foreground",children:t.length?`${t.length} fields`:"No data"})})]},a)}):s.jsxs(c,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(x,{className:"text-base",children:"Summary"})}),s.jsx(o,{children:s.jsx("div",{className:"text-sm text-muted-foreground",children:"No summary data."})})]})}),s.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.jsxs(c,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(x,{className:"text-base",children:"Top pending by contact"})}),s.jsx(o,{children:u?s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"h-4 w-64"}),s.jsx(l,{className:"h-4 w-56"}),s.jsx(l,{className:"h-4 w-72"})]}):j.length?s.jsx("ul",{className:"space-y-2","aria-label":"Top pending chart",children:j.map((e,a)=>{const t=y>0?Math.max(2,Math.round(e.pending/y*100)):0;return s.jsxs("li",{className:"text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"truncate pr-2",title:e.name,children:e.name}),s.jsx("span",{className:"tabular-nums",children:e.pending})]}),s.jsx("div",{className:"h-2 w-full bg-gray-200 rounded",children:s.jsx("div",{className:"h-2 bg-blue-500 rounded",style:{width:`${t}%`},"aria-label":`${e.name} ${e.pending}`})})]},a)})}):s.jsx("div",{className:"text-sm text-muted-foreground",children:"No pending items."})})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs(c,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(x,{className:"text-base",children:"Meta"})}),s.jsx(o,{children:w?s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"h-4 w-56"}),s.jsx(l,{className:"h-4 w-40"}),s.jsx(l,{className:"h-4 w-64"})]}):b.length?s.jsx("ul",{className:"text-sm list-disc pl-5 space-y-1",children:b.map((e,a)=>{const t=Object.entries(e||{}),d=String(t.find(([i])=>/name|module|label|title/i.test(i))?.[1]??`Module ${a+1}`),n=String(t.find(([i])=>/desc|help|info/i.test(i))?.[1]??"");return s.jsxs("li",{children:[s.jsx("span",{className:"font-medium",children:d}),n?s.jsxs("span",{className:"text-muted-foreground",children:[" — ",n]}):null]},a)})}):s.jsx("div",{className:"text-sm text-muted-foreground",children:"No meta information."})})]}),s.jsxs(c,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(x,{className:"text-base",children:"Quick actions"})}),s.jsxs(o,{className:"flex gap-2",children:[s.jsx(p,{asChild:!0,children:s.jsx("a",{href:"/transactions",children:"Transactions"})}),s.jsx(p,{asChild:!0,variant:"outline",children:s.jsx("a",{href:"/repayments",children:"Repayments"})}),s.jsx(p,{asChild:!0,variant:"outline",children:s.jsx("a",{href:"/contacts",children:"Contacts"})})]})]})]})]})};export{C as default};
