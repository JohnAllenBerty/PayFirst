import{u as S,a as T,r as u,j as s,C as d,b as m,c as h,d as o,B as N}from"./index-ziP5N0MA.js";import{S as l}from"./skeleton-ij2Kflz_.js";import{u as P}from"./useMeta-0Sjvc2pO.js";const O=()=>{const{data:f,isLoading:g}=S(),{data:b,isLoading:w}=T(),{title:M}=P("/","Dashboard • PayFirst"),c=u.useMemo(()=>{const e=f;return e?Array.isArray(e)?e:typeof e!="string"&&e?.status?e?.data??[]:[]:[]},[f]),y=u.useMemo(()=>{const e=b;return e?Array.isArray(e)?e:typeof e!="string"&&e?.status?e?.data??[]:[]:[]},[b]),p=u.useMemo(()=>{const e=(t,a)=>t.reduce((r,i)=>{const n=Object.entries(i).find(([C])=>a.test(C))?.[1],x=typeof n=="number"?n:Number(n??0);return r+(isFinite(x)?x:0)},0);return{totalTxn:e(c,/total_transaction_amount/i),totalRep:e(c,/total_repayment_amount/i),totalPending:e(c,/pending_amount/i)}},[c]),j=u.useMemo(()=>c.map(a=>{const r=String(Object.entries(a).find(([x])=>/name|label|contact/i.test(x))?.[1]??"Unknown"),i=Object.entries(a).find(([x])=>/pending_amount/i.test(x))?.[1],n=typeof i=="number"?i:Number(i??0);return{name:r,pending:isFinite(n)?n:0}}).sort((a,r)=>r.pending-a.pending).slice(0,5),[c]),v=u.useMemo(()=>Math.max(0,...j.map(e=>e.pending)),[j]);return s.jsxs("div",{className:"h-full bg-gray-50 p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold",children:M.replace(/\s*•\s*PayFirst$/,"")}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Overview and quick insights."})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[{title:"Total transactions",value:p.totalTxn},{title:"Total repayments",value:p.totalRep},{title:"Pending amount",value:p.totalPending}].map((e,t)=>s.jsxs(d,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(h,{className:"text-base",children:e.title})}),s.jsx(o,{children:g?s.jsx(l,{className:"h-8 w-24"}):s.jsx("div",{className:"text-2xl font-semibold",children:e.value})})]},t))}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g?Array.from({length:3}).map((e,t)=>s.jsxs(d,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(l,{className:"h-5 w-40"})}),s.jsx(o,{children:s.jsx(l,{className:"h-8 w-24"})})]},t)):c.length?c.map((e,t)=>{const a=Object.entries(e||{}),r=String(a.find(([n])=>/name|label|contact/i.test(n))?.[1]??`Item ${t+1}`),i=a.find(([n])=>/pending|amount|total/i.test(n))?.[1];return s.jsxs(d,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(h,{className:"text-base",children:r})}),s.jsx(o,{children:typeof i=="number"?s.jsx("div",{className:"text-2xl font-semibold",children:i}):s.jsx("div",{className:"text-sm text-muted-foreground",children:a.length?`${a.length} fields`:"No data"})})]},t)}):s.jsxs(d,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(h,{className:"text-base",children:"Summary"})}),s.jsx(o,{children:s.jsx("div",{className:"text-sm text-muted-foreground",children:"No summary data."})})]})}),s.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.jsxs(d,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(h,{className:"text-base",children:"Top pending by contact"})}),s.jsx(o,{children:g?s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"h-4 w-64"}),s.jsx(l,{className:"h-4 w-56"}),s.jsx(l,{className:"h-4 w-72"})]}):j.length?s.jsx("ul",{className:"space-y-2","aria-label":"Top pending chart",children:j.map((e,t)=>{const a=v>0?Math.max(2,Math.round(e.pending/v*100)):0;return s.jsxs("li",{className:"text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"truncate pr-2",title:e.name,children:e.name}),s.jsx("span",{className:"tabular-nums",children:e.pending})]}),s.jsx("div",{className:"h-2 w-full bg-gray-200 rounded",children:s.jsx("div",{className:"h-2 bg-blue-500 rounded",style:{width:`${a}%`},"aria-label":`${e.name} ${e.pending}`})})]},t)})}):s.jsx("div",{className:"text-sm text-muted-foreground",children:"No pending items."})})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs(d,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(h,{className:"text-base",children:"Meta"})}),s.jsx(o,{children:w?s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"h-4 w-56"}),s.jsx(l,{className:"h-4 w-40"}),s.jsx(l,{className:"h-4 w-64"})]}):y.length?s.jsx("ul",{className:"text-sm list-disc pl-5 space-y-1",children:y.map((e,t)=>{const a=Object.entries(e||{}),r=String(a.find(([n])=>/name|module|label|title/i.test(n))?.[1]??`Module ${t+1}`),i=String(a.find(([n])=>/desc|help|info/i.test(n))?.[1]??"");return s.jsxs("li",{children:[s.jsx("span",{className:"font-medium",children:r}),i?s.jsxs("span",{className:"text-muted-foreground",children:[" — ",i]}):null]},t)})}):s.jsx("div",{className:"text-sm text-muted-foreground",children:"No meta information."})})]}),s.jsxs(d,{className:"shadow-sm",children:[s.jsx(m,{children:s.jsx(h,{className:"text-base",children:"Quick actions"})}),s.jsxs(o,{className:"flex gap-2",children:[s.jsx(N,{asChild:!0,children:s.jsx("a",{href:"transactions",children:"Transactions"})}),s.jsx(N,{asChild:!0,variant:"outline",children:s.jsx("a",{href:"repayments",children:"Repayments"})}),s.jsx(N,{asChild:!0,variant:"outline",children:s.jsx("a",{href:"contact",children:"Contacts"})})]})]})]})]})};export{O as default};
