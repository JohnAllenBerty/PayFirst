import{v as n,a2 as Z,x as s,z as w,j as h,Z as $,I as k,P as A,R as q}from"./index-DnKD0KXe.js";import{a as D}from"./useMeta-Do0ZXGYI-DbPzVoKD.js";const U=()=>{const{title:z}=D("/change-password","Change Password • PayFirst"),[x,m]=n.useState(""),[i,j]=n.useState(""),[f,g]=n.useState(""),[v,_]=n.useState(null),[y,c]=n.useState(null),[a,N]=n.useState({}),[S,b]=n.useState(null),[B,{isLoading:I}]=Z(),L=async e=>{if(e.preventDefault(),_(null),c(null),N({}),b(null),!x||!i)return c("Both current and new password are required");if(i!==f){b("New passwords do not match");return}try{const t=await B({password:x,new_password:i}).unwrap(),l=k(t,"Password changed successfully");_(l),A.success(l),m(""),j(""),g("")}catch(t){c(o=>o??"Failed to change password");const l=(o=>{if(o&&typeof o=="object"){const P=o,p=P.data??P,d=typeof p.error=="object"&&p.error?p.error:p,r={},u=F=>Array.isArray(F)?F.filter(R=>typeof R=="string"):void 0;if(d.password&&(r.password=u(d.password)),d.new_password&&(r.new_password=u(d.new_password)),d.non_field_errors&&(r.non_field_errors=u(d.non_field_errors)),typeof d.detail=="string"&&(r.detail=d.detail),r.password||r.new_password||r.non_field_errors||r.detail)return r}})(t);l&&N(l);const C=q(t);c(C),A.error(C)}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold",children:z.replace(/\s*•\s*PayFirst$/,"")}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Update your account password."})]}),s.jsxs("form",{onSubmit:L,className:"grid gap-4 max-w-md p-4 border rounded-md",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(w,{htmlFor:"current",children:"Current password"}),s.jsx(h,{id:"current",type:"password",value:x,onChange:e=>m(e.target.value)}),a.password?.length?s.jsx("ul",{className:"text-xs text-red-600 list-disc pl-5",children:a.password.map((e,t)=>s.jsx("li",{children:e},t))}):null]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(w,{htmlFor:"new",children:"New password"}),s.jsx(h,{id:"new",type:"password",value:i,onChange:e=>j(e.target.value)}),a.new_password?.length?s.jsx("ul",{className:"text-xs text-red-600 list-disc pl-5",children:a.new_password.map((e,t)=>s.jsx("li",{children:e},t))}):null]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(w,{htmlFor:"confirm",children:"Confirm new password"}),s.jsx(h,{id:"confirm",type:"password",value:f,onChange:e=>g(e.target.value)}),S?s.jsx("div",{className:"text-xs text-red-600",children:S}):null]}),a.non_field_errors?.length?s.jsx("div",{className:"text-sm text-red-600",children:a.non_field_errors.join(" ")}):null,a.detail?s.jsx("div",{className:"text-sm text-red-600",children:a.detail}):null,y&&s.jsx("div",{className:"text-sm text-red-600",children:y}),v&&s.jsx("div",{className:"text-sm text-green-600",children:v}),s.jsx("div",{children:s.jsx($,{type:"submit",disabled:I,children:"Change password"})})]})]})};export{U as default};
