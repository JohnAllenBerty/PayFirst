import{j as s}from"./vendor-radix-DPBOYssM.js";import{u as A,a as P,b as R,C as d,c as o,d as x,e as m,B as p,o as _}from"./index-Bo_cs1vB.js";import{S as l}from"./skeleton-CIzvk2dr.js";import{u as $}from"./useMeta-DSGJavm9.js";import{E as O,r as u}from"./vendor-redux-Waidrk23.js";import"./vendor-react-gH-7aFTg.js";import"./vendor-router-Du5tOU4S.js";const H=()=>{const{hasToken:f}=A(),{data:b,isLoading:g}=P(void 0,{skip:!f}),{data:y,isLoading:M}=R(void 0,{skip:!f}),{title:T}=$("/","Dashboard • PayFirst"),C=O(),k=()=>{console.log("[Dashboard] Testing auth modal"),C(_("test"))},c=u.useMemo(()=>{const e=b;return e?Array.isArray(e)?e:typeof e!="string"&&e?.status?e?.data??[]:[]:[]},[b]),v=u.useMemo(()=>{const e=y;return e?Array.isArray(e)?e:typeof e!="string"&&e?.status?e?.data??[]:[]:[]},[y]),N=u.useMemo(()=>{const e=(a,t)=>a.reduce((r,i)=>{const n=Object.entries(i).find(([S])=>t.test(S))?.[1],h=typeof n=="number"?n:Number(n??0);return r+(isFinite(h)?h:0)},0);return{totalTxn:e(c,/total_transaction_amount/i),totalRep:e(c,/total_repayment_amount/i),totalPending:e(c,/pending_amount/i)}},[c]),j=u.useMemo(()=>c.map(t=>{const r=String(Object.entries(t).find(([h])=>/name|label|contact/i.test(h))?.[1]??"Unknown"),i=Object.entries(t).find(([h])=>/pending_amount/i.test(h))?.[1],n=typeof i=="number"?i:Number(i??0);return{name:r,pending:isFinite(n)?n:0}}).sort((t,r)=>r.pending-t.pending).slice(0,5),[c]),w=u.useMemo(()=>Math.max(0,...j.map(e=>e.pending)),[j]);return s.jsxs("div",{className:"h-full bg-gray-50 p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold",children:T.replace(/\s*•\s*PayFirst$/,"")}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Overview and quick insights."})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[{title:"Total transactions",value:N.totalTxn},{title:"Total repayments",value:N.totalRep},{title:"Pending amount",value:N.totalPending}].map((e,a)=>s.jsxs(d,{className:"shadow-sm",children:[s.jsx(o,{children:s.jsx(x,{className:"text-base",children:e.title})}),s.jsx(m,{children:g?s.jsx(l,{className:"h-8 w-24"}):s.jsx("div",{className:"text-2xl font-semibold",children:e.value})})]},a))}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g?Array.from({length:3}).map((e,a)=>s.jsxs(d,{className:"shadow-sm",children:[s.jsx(o,{children:s.jsx(l,{className:"h-5 w-40"})}),s.jsx(m,{children:s.jsx(l,{className:"h-8 w-24"})})]},a)):c.length?c.map((e,a)=>{const t=Object.entries(e||{}),r=String(t.find(([n])=>/name|label|contact/i.test(n))?.[1]??`Item ${a+1}`),i=t.find(([n])=>/pending|amount|total/i.test(n))?.[1];return s.jsxs(d,{className:"shadow-sm",children:[s.jsx(o,{children:s.jsx(x,{className:"text-base",children:r})}),s.jsx(m,{children:typeof i=="number"?s.jsx("div",{className:"text-2xl font-semibold",children:i}):s.jsx("div",{className:"text-sm text-muted-foreground",children:t.length?`${t.length} fields`:"No data"})})]},a)}):s.jsxs(d,{className:"shadow-sm",children:[s.jsx(o,{children:s.jsx(x,{className:"text-base",children:"Summary"})}),s.jsx(m,{children:s.jsx("div",{className:"text-sm text-muted-foreground",children:"No summary data."})})]})}),s.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.jsxs(d,{className:"shadow-sm",children:[s.jsx(o,{children:s.jsx(x,{className:"text-base",children:"Top pending by contact"})}),s.jsx(m,{children:g?s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"h-4 w-64"}),s.jsx(l,{className:"h-4 w-56"}),s.jsx(l,{className:"h-4 w-72"})]}):j.length?s.jsx("ul",{className:"space-y-2","aria-label":"Top pending chart",children:j.map((e,a)=>{const t=w>0?Math.max(2,Math.round(e.pending/w*100)):0;return s.jsxs("li",{className:"text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"truncate pr-2",title:e.name,children:e.name}),s.jsx("span",{className:"tabular-nums",children:e.pending})]}),s.jsx("div",{className:"h-2 w-full bg-gray-200 rounded",children:s.jsx("div",{className:"h-2 bg-blue-500 rounded",style:{width:`${t}%`},"aria-label":`${e.name} ${e.pending}`})})]},a)})}):s.jsx("div",{className:"text-sm text-muted-foreground",children:"No pending items."})})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs(d,{className:"shadow-sm",children:[s.jsx(o,{children:s.jsx(x,{className:"text-base",children:"Meta"})}),s.jsx(m,{children:M?s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"h-4 w-56"}),s.jsx(l,{className:"h-4 w-40"}),s.jsx(l,{className:"h-4 w-64"})]}):v.length?s.jsx("ul",{className:"text-sm list-disc pl-5 space-y-1",children:v.map((e,a)=>{const t=Object.entries(e||{}),r=String(t.find(([n])=>/name|module|label|title/i.test(n))?.[1]??`Module ${a+1}`),i=String(t.find(([n])=>/desc|help|info/i.test(n))?.[1]??"");return s.jsxs("li",{children:[s.jsx("span",{className:"font-medium",children:r}),i?s.jsxs("span",{className:"text-muted-foreground",children:[" — ",i]}):null]},a)})}):s.jsx("div",{className:"text-sm text-muted-foreground",children:"No meta information."})})]}),s.jsxs(d,{className:"shadow-sm",children:[s.jsx(o,{children:s.jsx(x,{className:"text-base",children:"Quick actions"})}),s.jsxs(m,{className:"flex gap-2 flex-wrap",children:[s.jsx(p,{asChild:!0,children:s.jsx("a",{href:"transactions",children:"Transactions"})}),s.jsx(p,{asChild:!0,variant:"outline",children:s.jsx("a",{href:"repayments",children:"Repayments"})}),s.jsx(p,{asChild:!0,variant:"outline",children:s.jsx("a",{href:"contact",children:"Contacts"})}),s.jsx(p,{variant:"destructive",onClick:k,children:"Test Auth Modal"})]})]})]})]})};export{H as default};
