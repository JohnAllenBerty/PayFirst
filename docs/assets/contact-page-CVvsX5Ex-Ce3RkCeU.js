import{v as n,g as ns,d as rs,b as is,c as ls,e as cs,k as ds,P as _,x as e,Z as l,j as X,z as E,I as H,R as ee,f as os,Y as us,l as ms,C as xs,o as ps,Q as hs,q as oe,s as fs,w as Le,D as Re,M as gs}from"./index-DnKD0KXe.js";import{o as K}from"./skeleton-mX7TdaWE-Cq_BwO7K.js";import{n as js,m as bs,p as U,f as de,x as vs,w as Ns,b as $,i as ys}from"./table-DQfnjL0Y-DmfacWdK.js";import{a as Cs}from"./useMeta-Do0ZXGYI-DbPzVoKD.js";import{y as ks,r as ws,d as Ss}from"./layout-list-ObnFiE7M-Cwvb1Wq-.js";import{o as Fe}from"./search-B37cGDDG-qSBiOTEd.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_s=xs("check",zs);function $s(r){const o=n.useRef({value:r,previous:r});return n.useMemo(()=>(o.current.value!==r&&(o.current.previous=o.current.value,o.current.value=r),o.current.previous),[r])}var se="Checkbox",[Ds,Vs]=ps(se),[Ms,ue]=Ds(se);function Es(r){const{__scopeCheckbox:o,checked:x,children:u,defaultChecked:p,disabled:d,form:h,name:v,onCheckedChange:m,required:C,value:j="on",internal_do_not_use_render:f}=r,[N,D]=fs({prop:x,defaultProp:p??!1,onChange:m,caller:se}),[y,k]=n.useState(null),[M,c]=n.useState(null),g=n.useRef(!1),q=y?!!h||!!y.closest("form"):!0,A={checked:N,disabled:d,setChecked:D,control:y,setControl:k,name:v,form:h,value:j,hasConsumerStoppedPropagationRef:g,required:C,defaultChecked:P(p)?!1:p,isFormControl:q,bubbleInput:M,setBubbleInput:c};return e.jsx(Ms,{scope:o,...A,children:Ps(f)?f(A):u})}var Ge="CheckboxTrigger",Ve=n.forwardRef(({__scopeCheckbox:r,onKeyDown:o,onClick:x,...u},p)=>{const{control:d,value:h,disabled:v,checked:m,required:C,setControl:j,setChecked:f,hasConsumerStoppedPropagationRef:N,isFormControl:D,bubbleInput:y}=ue(Ge,r),k=Le(p,j),M=n.useRef(m);return n.useEffect(()=>{const c=d?.form;if(c){const g=()=>f(M.current);return c.addEventListener("reset",g),()=>c.removeEventListener("reset",g)}},[d,f]),e.jsx(oe.button,{type:"button",role:"checkbox","aria-checked":P(m)?"mixed":m,"aria-required":C,"data-state":Ue(m),"data-disabled":v?"":void 0,disabled:v,value:h,...u,ref:k,onKeyDown:Re(o,c=>{c.key==="Enter"&&c.preventDefault()}),onClick:Re(x,c=>{f(g=>P(g)?!0:!g),y&&D&&(N.current=c.isPropagationStopped(),N.current||c.stopPropagation())})})});Ve.displayName=Ge;var qe=n.forwardRef((r,o)=>{const{__scopeCheckbox:x,name:u,checked:p,defaultChecked:d,required:h,disabled:v,value:m,onCheckedChange:C,form:j,...f}=r;return e.jsx(Es,{__scopeCheckbox:x,checked:p,defaultChecked:d,disabled:v,required:h,onCheckedChange:C,name:u,form:j,value:m,internal_do_not_use_render:({isFormControl:N})=>e.jsxs(e.Fragment,{children:[e.jsx(Ve,{...f,ref:o,__scopeCheckbox:x}),N&&e.jsx(Ke,{__scopeCheckbox:x})]})})});qe.displayName=se;var Be="CheckboxIndicator",Oe=n.forwardRef((r,o)=>{const{__scopeCheckbox:x,forceMount:u,...p}=r,d=ue(Be,x);return e.jsx(hs,{present:u||P(d.checked)||d.checked===!0,children:e.jsx(oe.span,{"data-state":Ue(d.checked),"data-disabled":d.disabled?"":void 0,...p,ref:o,style:{pointerEvents:"none",...r.style}})})});Oe.displayName=Be;var Te="CheckboxBubbleInput",Ke=n.forwardRef(({__scopeCheckbox:r,...o},x)=>{const{control:u,hasConsumerStoppedPropagationRef:p,checked:d,defaultChecked:h,required:v,disabled:m,name:C,value:j,form:f,bubbleInput:N,setBubbleInput:D}=ue(Te,r),y=Le(x,D),k=$s(d),M=gs(u);n.useEffect(()=>{const g=N;if(!g)return;const q=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(q,"checked").set,te=!p.current;if(k!==d&&A){const ae=new Event("click",{bubbles:te});g.indeterminate=P(d),A.call(g,P(d)?!1:d),g.dispatchEvent(ae)}},[N,k,d,p]);const c=n.useRef(P(d)?!1:d);return e.jsx(oe.input,{type:"checkbox","aria-hidden":!0,defaultChecked:h??c.current,required:v,disabled:m,name:C,value:j,form:f,...o,tabIndex:-1,ref:y,style:{...o.style,...M,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Ke.displayName=Te;function Ps(r){return typeof r=="function"}function P(r){return r==="indeterminate"}function Ue(r){return P(r)?"indeterminate":r?"checked":"unchecked"}function Ie({className:r,...o}){return e.jsx(qe,{"data-slot":"checkbox",className:ms("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...o,children:e.jsx(Oe,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(_s,{className:"size-3.5"})})})}const qs=()=>{const[r,o]=n.useState("name"),[x,u]=n.useState(1),[p,d]=n.useState(10),[h,v]=n.useState(!1),[m,C]=n.useState(""),[j,f]=n.useState({name:""}),[N,D]=n.useState(0),{data:y,isLoading:k,isFetching:M}=ns({page:h?1:x,page_size:h?1e3:p,ordering:r,search:j.name||void 0,refresh:N}),{data:c,isLoading:g,refetch:q}=rs(),[A,{isLoading:te}]=is(),[ae,{isLoading:Ze}]=ls(),[Je,{isLoading:Z}]=cs(),[ne,me]=n.useState(""),[xe,pe]=n.useState([]),[he,J]=n.useState(null),[Qe,B]=n.useState(!1),[fe,ge]=n.useState(null),[je,O]=n.useState(null),[be,R]=n.useState(null),[ve,Q]=n.useState(""),[Ne,Y]=n.useState([]),[ye,G]=n.useState(null),[Ce,Ye]=n.useState(null),[We,T]=n.useState(!1),[ke,we]=n.useState(null),[Se,Xe]=n.useState("google"),[He,{isLoading:ze}]=ds(),b=n.useMemo(()=>c&&typeof c!="string"&&c?.status?c?.data:[],[c]),_e=n.useMemo(()=>{const s=y;if(!s)return{items:[],total:0};if(s.status===!0){const a=s.data;return Array.isArray(a)?{items:a,total:a.length}:{items:a.results??[],total:a.count??(a.results?a.results.length:0)}}if(s.status===!1)return{items:[],total:0};const t=s;return Array.isArray(t.results)?{items:t.results,total:t.count}:{items:[],total:0}},[y]),F=_e.items,W=_e.total,$e=typeof c=="string"?c:c&&typeof c!="string"&&c.status===!1?String(c.error??"Server error"):null,De=(()=>{const s=y;return s&&s.status===!1?String(s.error??"Server error"):null})(),es=(s,t)=>{pe(a=>t?Array.from(new Set([...a,s])):a.filter(i=>i!==s))},ss=async s=>{if(s.preventDefault(),J(null),!ne.trim())return J("Name is required"),!1;try{const t=new FormData;t.append("name",ne.trim()),xe.forEach(i=>t.append("groups",String(i))),fe&&t.append("picture",fe);const a=await A(t).unwrap();return me(""),pe([]),ge(null),_.success(H(a,"Contact created")),!0}catch(t){const a=ee(t);return J(a),_.error(a),!1}},Me=n.useMemo(()=>Array.isArray(b)&&b.some(s=>Array.isArray(s.subgroups)&&s.subgroups.length>0),[b]),Ee=n.useMemo(()=>{if(!b)return[];if(Me){const a=i=>({id:i.id,name:i.name,parent_group:i.parent_group??null,children:Array.isArray(i.subgroups)?i.subgroups.map(a):[]});return b.map(a)}const s=new Map,t=[];return b.forEach(a=>s.set(a.id,{id:a.id,name:a.name,parent_group:a.parent_group??null,children:[]})),b.forEach(a=>{const i=s.get(a.id);a.parent_group&&s.has(a.parent_group)?s.get(a.parent_group).children.push(i):t.push(i)}),t},[b,Me]),ts=n.useMemo(()=>{const s=new Map;return F.forEach(t=>{(t.groups||[]).forEach(a=>{const i=s.get(a)||[];i.push(t),s.set(a,i)})}),s},[F]),re=n.useMemo(()=>F.filter(s=>!s.groups||s.groups.length===0),[F]),Pe=n.useRef("");n.useEffect(()=>{if(!(j.name&&j.name.trim()))return;const s=W,t=`${j.name}`;!k&&s===0&&Pe.current!==t&&(Pe.current=t,_.info("No contacts match your filter. Adjust or clear filters to see results."))},[j.name,W,k]);const Ae=({node:s,depth:t,contactsByGroup:a,onView:i,onEdit:I,onDelete:w})=>{const[V,S]=os.useState(!0),L=s.children||[],ie=a.get(s.id)||[],le=L.length>0,ce=ie.length>0;return e.jsxs("li",{className:"text-sm",style:{paddingLeft:t*12},children:[e.jsx("div",{className:"flex items-center justify-between py-1.5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[le||ce?e.jsx("button",{type:"button","aria-label":V?"Collapse":"Expand",className:"text-muted-foreground hover:text-foreground transition-colors",onClick:()=>S(z=>!z),children:V?e.jsx(Ss,{className:"size-4"}):e.jsx(us,{className:"size-4"})}):e.jsx("span",{className:"inline-block w-4"}),e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx("span",{children:s.name}),(ce||le)&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",ie.length,le?`, ${L.length} sub`:"",")"]})]})]})}),V&&e.jsxs("div",{className:"ml-3",children:[ce&&e.jsx("ul",{className:"space-y-1",children:ie.map(z=>e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsx("span",{children:z.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>i(z.id),children:"View"}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(z),children:"Edit"}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>w(z.id),disabled:Z,children:"Delete"})]})]},z.id))}),L.length>0&&e.jsx("ul",{className:"border-l pl-3 mt-1",children:L.map(z=>e.jsx(Ae,{node:z,depth:t+1,contactsByGroup:a,onView:i,onEdit:I,onDelete:w},z.id))})]})]})},{title:as}=Cs("/contact","Contacts • PayFirst");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:as.replace(/\s*•\s*PayFirst$/,"")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your contacts and assign them to groups."})]}),$e&&e.jsxs("div",{className:"max-w-xl rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 flex items-center justify-between gap-3",children:[e.jsx("span",{children:$e}),e.jsx(l,{type:"button",size:"sm",variant:"outline",onClick:()=>q(),children:"Retry"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(l,{size:"sm",variant:"outline",onClick:()=>T(!0),children:"Import CSV"})}),e.jsx(l,{size:"sm",onClick:()=>{B(!0),J(null)},children:"New Contact"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h2",{className:"font-medium",children:"All contacts"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[!h&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-muted-foreground",htmlFor:"contact-page-size",children:"Rows per page"}),e.jsxs("select",{id:"contact-page-size",className:"h-8 rounded-md border bg-background px-2 text-sm",value:p,onChange:s=>{d(Number(s.target.value)),u(1)},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]}),e.jsxs(l,{variant:h?"default":"outline",size:"sm",className:"gap-1",onClick:()=>{v(!0),u(1)},children:[e.jsx(ks,{className:"size-4"})," Tree"]}),e.jsxs(l,{variant:h?"outline":"default",size:"sm",className:"gap-1",onClick:()=>v(!1),children:[e.jsx(ws,{className:"size-4"})," List"]})]})]}),De&&e.jsxs("div",{className:"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 flex items-center justify-between gap-3",children:[e.jsx("span",{children:De}),e.jsx(l,{type:"button",size:"sm",variant:"outline",onClick:()=>D(s=>s+1),children:"Retry"})]}),h?e.jsxs("div",{className:"rounded-md border divide-y",children:[e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(X,{value:m,onChange:s=>C(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),f({name:m.trim().toLowerCase()}),u(1))},placeholder:"Filter name…",className:"pl-8 h-8 w-64"}),e.jsx(Fe,{className:"absolute left-2 top-2 size-4 text-muted-foreground"})]}),e.jsx(l,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2",disabled:M,onClick:()=>{f({name:m.trim().toLowerCase()}),u(1)},children:"Apply"})]}),e.jsxs("ul",{className:"p-2",children:[Ee.map(s=>e.jsx(Ae,{node:s,depth:0,contactsByGroup:ts,onView:t=>O(t),onEdit:t=>{R(t.id),Q(t.name),Y(t.groups||[])},onDelete:t=>G(t)},s.id)),re.length>0&&e.jsxs("li",{className:"pt-2",children:[e.jsx("div",{className:"font-medium text-sm mb-1",children:"Ungrouped"}),e.jsx("ul",{className:"ml-3 space-y-1",children:re.map(s=>e.jsxs("li",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>O(s.id),children:"View"}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>{R(s.id),Q(s.name),Y(s.groups||[])},children:"Edit"}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>G(s.id),disabled:Z,children:"Delete"})]})]},s.id))})]}),Ee.length===0&&re.length===0&&e.jsx("li",{className:"text-sm text-muted-foreground",children:"No contacts found"})]})]}):e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(js,{children:[e.jsxs(bs,{children:[e.jsxs(U,{children:[e.jsx(de,{className:"cursor-pointer select-none",onClick:()=>o(s=>s==="name"?"-name":"name"),children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:["Name ",r.includes("name")&&(r.startsWith("-")?e.jsx(vs,{className:"size-4"}):e.jsx(Ns,{className:"size-4"}))]})}),e.jsx(de,{children:"Groups"}),e.jsx(de,{className:"w-[1%] whitespace-nowrap text-right pr-3",children:"Actions"})]}),e.jsxs(U,{children:[e.jsx($,{children:e.jsxs("div",{className:"relative",children:[e.jsx(X,{value:m,onChange:s=>{C(s.target.value)},onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),f({name:m.trim().toLowerCase()}),u(1))},placeholder:"Filter name…",className:"pl-8 h-8"}),e.jsx(Fe,{className:"absolute left-2 top-2 size-4 text-muted-foreground"})]})}),e.jsx($,{}),e.jsx($,{className:"text-right pr-3",children:e.jsx(l,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2",disabled:M,onClick:()=>{f({name:m.trim().toLowerCase()}),u(1)},children:"Apply"})})]})]}),e.jsx(ys,{children:k?Array.from({length:5}).map((s,t)=>e.jsxs(U,{children:[e.jsx($,{children:e.jsx(K,{className:"h-4 w-40"})}),e.jsx($,{children:e.jsx(K,{className:"h-4 w-24"})}),e.jsx($,{className:"text-right pr-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(K,{className:"h-8 w-16"}),e.jsx(K,{className:"h-8 w-16"}),e.jsx(K,{className:"h-8 w-16"})]})})]},t)):F.length?F.map(s=>e.jsxs(U,{children:[e.jsx($,{children:e.jsx("div",{className:"font-medium",children:s.name})}),e.jsx($,{className:"text-muted-foreground",children:(()=>{const t=new Map;b.forEach(w=>t.set(w.id,w));const a=w=>{const V=[];let S=t.get(w);const L=new Set;for(;S&&!L.has(S.id)&&(L.add(S.id),V.unshift(S.name),S.parent_group&&t.has(S.parent_group));)S=t.get(S.parent_group);return V.join(" > ")},i=s.groups||[];if(!i.length)return"—";const I=i.map(a).filter(Boolean);return I.length?I.join(", "):i.map(w=>t.get(w)?.name||String(w)).join(", ")})()}),e.jsx($,{className:"text-right pr-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>O(s.id),children:"View"}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>{R(s.id),Q(s.name),Y(s.groups||[])},children:"Edit"}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>G(s.id),disabled:Z,children:"Delete"})]})})]},s.id)):e.jsx(U,{children:e.jsx($,{colSpan:3,className:"text-sm text-muted-foreground",children:"No contacts found"})})})]})}),(()=>{const s=Math.max(1,Math.ceil(W/p));return!h&&W>0?e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>u(t=>Math.max(1,t-1)),disabled:x===1,children:"Prev"}),e.jsxs("span",{className:"text-xs",children:["Page ",x," of ",s]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>u(t=>Math.min(s,t+1)),disabled:x>=s,children:"Next"})]}):null})()]}),Qe&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>B(!1),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"new-contact-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"new-contact-title",className:"font-semibold",children:"New contact"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>B(!1),children:"Close"})]}),e.jsxs("form",{onSubmit:async s=>{await ss(s)&&B(!1)},className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"name",children:"Name"}),e.jsx(X,{id:"name",value:ne,onChange:s=>me(s.target.value),placeholder:"Jane Doe"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"picture",children:"Picture"}),e.jsx("input",{id:"picture",type:"file",accept:"image/*",onChange:s=>ge(s.target.files?.[0]||null),className:"h-9 rounded-md border bg-background px-2 text-sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Optional. JPG/PNG recommended."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:"Groups"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:g?e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading groups…"}):b.length?b.map(s=>e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ie,{checked:xe.includes(s.id),onCheckedChange:t=>es(s.id,!!t)}),e.jsx("span",{children:s.name})]},s.id)):e.jsx("span",{className:"text-sm text-muted-foreground",children:"No groups yet"})})]}),he&&e.jsx("div",{className:"text-sm text-red-600",children:he}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>B(!1),children:"Cancel"}),e.jsx(l,{type:"submit",disabled:te,children:"Create"})]})]})]})}),je!==null&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>O(null),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"view-contact-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"view-contact-title",className:"font-semibold",children:"Contact details"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>O(null),children:"Close"})]}),(()=>{const s=F.find(a=>a.id===je);if(!s)return e.jsx("div",{className:"text-sm",children:"Not found"});const t=(s.groups||[]).map(a=>b.find(i=>i.id===a)?.name||String(a));return e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"})," ",s.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Groups:"})," ",t.length?t.join(", "):"—"]})]})})()]})}),be!==null&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>R(null),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"edit-contact-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"edit-contact-title",className:"font-semibold",children:"Edit contact"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>R(null),children:"Close"})]}),e.jsxs("form",{className:"grid gap-3",onSubmit:async s=>{s.preventDefault();try{const t=be,a=new FormData;a.append("name",ve.trim()),Ne.forEach(I=>a.append("groups",String(I))),Ce&&a.append("picture",Ce);const i=await ae({id:t,changes:a}).unwrap();_.success(H(i,"Contact updated")),R(null)}catch(t){_.error(ee(t))}},children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"edit-name",children:"Name"}),e.jsx(X,{id:"edit-name",value:ve,onChange:s=>Q(s.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"edit-picture",children:"Picture"}),e.jsx("input",{id:"edit-picture",type:"file",accept:"image/*",onChange:s=>{const t=s.target.files?.[0]||null;Ye(t)},className:"h-9 rounded-md border bg-background px-2 text-sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Optional. Upload to replace existing picture."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{children:"Groups"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:b.map(s=>e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ie,{checked:Ne.includes(s.id),onCheckedChange:t=>Y(a=>t?Array.from(new Set([...a,s.id])):a.filter(i=>i!==s.id))}),e.jsx("span",{children:s.name})]},s.id))})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>R(null),children:"Cancel"}),e.jsx(l,{type:"submit",disabled:Ze,children:"Save"})]})]})]})}),ye!==null&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>G(null),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"delete-contact-title",className:"bg-background rounded-md p-4 w-[420px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{id:"delete-contact-title",className:"font-semibold mb-2",children:"Delete contact"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"This action cannot be undone."}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>G(null),children:"Cancel"}),e.jsx(l,{variant:"destructive",disabled:Z,onClick:async()=>{try{const s=await Je(ye).unwrap();_.success(H(s,"Contact deleted"))}catch(s){_.error(ee(s))}finally{G(null)}},children:"Delete"})]})]})}),We&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",onClick:()=>T(!1),children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"import-contacts-title",className:"bg-background rounded-md p-4 w-[520px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{id:"import-contacts-title",className:"font-semibold",children:"Import contacts from CSV"}),e.jsx("button",{"aria-label":"Close dialog",className:"text-sm text-muted-foreground",onClick:()=>T(!1),children:"Close"})]}),e.jsxs("form",{className:"grid gap-3",onSubmit:async s=>{if(s.preventDefault(),!ke){_.error("Please choose a CSV file");return}try{const t=await He({file:ke,_type:Se}).unwrap();_.success(H(t,"Import started")),T(!1),we(null),D(a=>a+1)}catch(t){_.error(ee(t))}},children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"import-file",children:"CSV file"}),e.jsx("input",{id:"import-file",type:"file",accept:".csv,text/csv",onChange:s=>we(s.target.files?.[0]||null),className:"h-9 rounded-md border bg-background px-2 text-sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Upload a CSV exported from Google Contacts."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(E,{htmlFor:"import-type",children:"Type"}),e.jsx("select",{id:"import-type",className:"h-9 rounded-md border bg-background px-2 text-sm",value:Se,onChange:s=>Xe(s.target.value),children:e.jsx("option",{value:"google",children:"Google"})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(l,{type:"submit",disabled:ze,children:ze?"Importing…":"Import"})]})]})]})})]})};export{qs as default};
