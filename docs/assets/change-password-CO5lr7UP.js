import{j as s}from"./vendor-radix-DPBOYssM.js";import{r as o}from"./vendor-redux-Waidrk23.js";import{W as q,L as x,I as w,B as D,j as R,y as M,k as T}from"./index-DPSrh-G_.js";import{u as U}from"./useMeta-CxZURuxa.js";import"./vendor-react-gH-7aFTg.js";import"./vendor-router-Du5tOU4S.js";const K=()=>{const{title:B}=U("/change-password","Change Password • PayFirst"),[p,h]=o.useState(""),[l,f]=o.useState(""),[g,j]=o.useState(""),[v,y]=o.useState(null),[_,i]=o.useState(null),[t,N]=o.useState({}),[P,C]=o.useState(null),[L,{isLoading:k}]=q(),A=async e=>{if(e.preventDefault(),y(null),i(null),N({}),C(null),!p||!l)return i("Both current and new password are required");if(l!==g){C("New passwords do not match");return}try{const a=await L({password:p,new_password:l}).unwrap(),u=R(a,"Password changed successfully");y(u),M.success(u),h(""),f(""),j("")}catch(a){i(d=>d??"Failed to change password");const S=(d=>{if(d&&typeof d=="object"){const b=d,c=b.data??b,n=typeof c.error=="object"&&c.error?c.error:c,r={},m=F=>Array.isArray(F)?F.filter(I=>typeof I=="string"):void 0;if(n.password&&(r.password=m(n.password)),n.new_password&&(r.new_password=m(n.new_password)),n.non_field_errors&&(r.non_field_errors=m(n.non_field_errors)),typeof n.detail=="string"&&(r.detail=n.detail),r.password||r.new_password||r.non_field_errors||r.detail)return r}})(a);S&&N(S);const E=T(a);i(E),M.error(E)}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold",children:B.replace(/\s*•\s*PayFirst$/,"")}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Update your account password."})]}),s.jsxs("form",{onSubmit:A,className:"grid gap-4 max-w-md p-4 border rounded-md",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(x,{htmlFor:"current",children:"Current password"}),s.jsx(w,{id:"current",type:"password",value:p,onChange:e=>h(e.target.value)}),t.password?.length?s.jsx("ul",{className:"text-xs text-red-600 list-disc pl-5",children:t.password.map((e,a)=>s.jsx("li",{children:e},a))}):null]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(x,{htmlFor:"new",children:"New password"}),s.jsx(w,{id:"new",type:"password",value:l,onChange:e=>f(e.target.value)}),t.new_password?.length?s.jsx("ul",{className:"text-xs text-red-600 list-disc pl-5",children:t.new_password.map((e,a)=>s.jsx("li",{children:e},a))}):null]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(x,{htmlFor:"confirm",children:"Confirm new password"}),s.jsx(w,{id:"confirm",type:"password",value:g,onChange:e=>j(e.target.value)}),P?s.jsx("div",{className:"text-xs text-red-600",children:P}):null]}),t.non_field_errors?.length?s.jsx("div",{className:"text-sm text-red-600",children:t.non_field_errors.join(" ")}):null,t.detail?s.jsx("div",{className:"text-sm text-red-600",children:t.detail}):null,_&&s.jsx("div",{className:"text-sm text-red-600",children:_}),v&&s.jsx("div",{className:"text-sm text-green-600",children:v}),s.jsx("div",{children:s.jsx(D,{type:"submit",disabled:k,children:"Change password"})})]})]})};export{K as default};
